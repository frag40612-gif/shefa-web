# مطلوب منكم — منصة شفاء (الباكند)

نفّذوا النقاط بالترتيب من 1 إلى 20. كل رقم = مهمة واحدة مطلوب تنفيذها.

---

## 1. تسجيل الدخول

- المطلوب: إنشاء مسار لتسجيل الدخول.
- الطريقة: POST.
- المسار: /user/login
- ما يستقبله: البريد الإلكتروني، وكلمة المرور.
- ما يرجعه: توكن (رمز دخول) + بيانات المستخدم. بيانات المستخدم تشمل: المعرّف، الاسم الكامل، البريد، الدور (طبيب أو مريض أو مرافق)، الهاتف، الجنس. إن كان طبيباً يضاف التخصص، وإن كان مريضاً يضاف العمر وفصيلة الدم والمرض، وإن كان مرافقاً يضاف صلة القرابة.
- شكل الرجوع: يكون في جسم الردّ: data فيها token و user.

---

## 2. تسجيل طبيب جديد

- المطلوب: إنشاء مسار لتسجيل طبيب.
- الطريقة: POST.
- المسار: /doctor/signup
- ما يستقبله: الاسم الكامل، البريد، كلمة المرور، الهاتف، الجنس، التخصص، أوقات العمل، والدور (طبيب).
- ما يرجعه: نفس شكل تسجيل الدخول (توكن + بيانات المستخدم).

---

## 3. تسجيل مريض جديد

- المطلوب: إنشاء مسار لتسجيل مريض.
- الطريقة: POST.
- المسار: /patient/signup
- ما يستقبله: الاسم الكامل، البريد، كلمة المرور، الهاتف، الجنس، العمر، المرض، الأدوية، فصيلة الدم، ومعرف الطبيب والمرافق إن وُجد (اختياري)، والدور (مريض).
- ما يرجعه: نفس شكل تسجيل الدخول.

---

## 4. تسجيل مرافق جديد

- المطلوب: إنشاء مسار لتسجيل مرافق.
- الطريقة: POST.
- المسار: /companion/signup
- ما يستقبله: الاسم الكامل، البريد، كلمة المرور، الهاتف، الجنس، صلة القرابة، معرف المريض، الخبرة، والدور (مرافق).
- ما يرجعه: نفس شكل تسجيل الدخول.

---

## 5. جلب الملف الشخصي

- المطلوب: مسار يجيب بيانات المستخدم الحالي.
- الطريقة: GET.
- المسار: /user/profile
- محمي: نعم. الواجهة الأمامية ترسل مع الطلب هيدر اسمه Authorization وقيمته Bearer ثم التوكن.
- ما يرجعه: بيانات المستخدم كاملة (نفس شكل المستخدم في تسجيل الدخول) حسب نوعه: طبيب أو مريض أو مرافق.

---

## 6. تحديث الملف الشخصي

- المطلوب: مسار لتعديل بيانات المستخدم.
- الطريقة: PUT.
- المسار: /user/profile
- محمي: نعم.
- ما يستقبله: الحقول التي يعدّلها المستخدم (الاسم، الهاتف، الجنس، وباقي الحقول حسب الدور: التخصص ودرجة التأهيل والخبرة للطبيب، العمر وفصيلة الدم والمرض للمريض، صلة القرابة والخبرة للمرافق).
- ما يرجعه: تأكيد أو الملف المحدّث.

---

## 7. طبيبي (للمريض)

- المطلوب: مسار يرجع بيانات الطبيب المرتبط بالمريض (لصفحة الطوارئ والاتصال).
- الطريقة: GET.
- المسار: /user/my-doctor
- محمي: نعم، للمريض.
- ما يرجعه: بيانات الطبيب ويشترط أن تشمل على الأقل: المعرّف، الاسم، رقم الهاتف، التخصص.

---

## 8. قائمة كل الأطباء

- المطلوب: مسار يرجع كل الأطباء (بدون تسجيل دخول).
- الطريقة: GET.
- المسار: /doctor/all
- محمي: لا.
- ما يرجعه: قائمة (مصفوفة). كل طبيب فيه: المعرّف، الاسم، رابط الصورة، التخصص، الدرجة العلمية، سنوات الخبرة، نبذة عنه، رسوم الكشف، والعنوان (سطر أول وسطر ثاني).

---

## 9. طبيب واحد بالمعرف

- المطلوب: مسار يرجع بيانات طبيب واحد عند إعطاء معرفه (لصفحة حجز الموعد).
- الطريقة: GET.
- المسار: /doctor/:id (بدل :id يوضع معرف الطبيب).
- محمي: لا.
- ما يرجعه: نفس شكل عنصر واحد من قائمة الأطباء.

---

## 10. حجز موعد

- المطلوب: مسار لحجز موعد مع طبيب.
- الطريقة: POST.
- المسار: /appointment/create
- محمي: نعم.
- ما يستقبله: معرف الطبيب، معرف المريض، التاريخ (مثل 2025-02-10)، الوقت (مثل 14:00)، سبب الزيارة، وملاحظات (اختياري).
- ما يرجعه: تأكيد أو بيانات الموعد المحجوز.

---

## 11. مواعيدي (للمريض)

- المطلوب: مسار يرجع كل مواعيد المريض.
- الطريقة: GET.
- المسار: /appointment/my-appointments
- محمي: نعم.
- ما يرجعه: قائمة مواعيد. كل موعد فيه: المعرّف، التاريخ، الوقت، السبب، الحالة (مؤكد أو قيد الانتظار أو ملغي)، وبيانات الطبيب (المعرّف، الاسم، الصورة، التخصص).

---

## 12. إلغاء موعد

- المطلوب: مسار لإلغاء موعد.
- الطريقة: DELETE.
- المسار: /appointment/:id (بدل :id معرف الموعد).
- محمي: نعم.
- ما يرجعه: تأكيد أن الموعد تم إلغاؤه.

---

## 13. البيانات الصحية (الساعة الذكية)

- المطلوب: مسار يرجع بيانات المستخدم الصحية (نبض، أكسجين، خطوات، نوم، توتر، تنبيهات، درجة الخطورة).
- الطريقة: GET.
- المسار: /health/data
- محمي: نعم.
- ما يرجعه: معدل النبض، نسبة الأكسجين، عدد الخطوات، ساعات النوم، مستوى التوتر، آخر تحديث، قائمة التنبيهات، ودرجة الخطورة (منخفضة أو متوسطة أو عالية).

---

## 14. مزامنة البيانات من الساعة

- المطلوب: مسار لمزامنة البيانات القادمة من الساعة الذكية.
- الطريقة: POST.
- المسار: /health/sync
- محمي: نعم.
- ما يرجعه: تأكيد. بعدها الواجهة الأمامية تعيد طلب بيانات الصحية (المسار السابق).

---

## 15. التحليلات الصحية (الرسوم البيانية)

- المطلوب: مسار يرجع بيانات لرسم منحنيات (نبض، أكسجين، نوم، خطوات) وتنبيهات ورؤى.
- الطريقة: GET.
- المسار: /health/analytics مع إرسال range (أسبوع أو شهر أو سنة).
- محمي: نعم.
- ما يرجعه: منحنيات النبض والأكسجين والنوم والخطوات (كل واحد قائمة تواريخ وقيم)، وقائمة شذوذات، وقائمة نصوص (رؤى).

---

## 16. تفعيل حالة الطوارئ

- المطلوب: مسار لتفعيل طوارئ من قبل المريض.
- الطريقة: POST.
- المسار: /emergency/trigger
- محمي: نعم.
- ما يستقبله: معرف المستخدم، الموقع (خط العرض وخط الطول)، التوقيت، والنوع (يدوي).
- ما يرجعه: تأكيد.

---

## 17. إشعار الطبيب بالطوارئ

- المطلوب: مسار لإرسال إشعار للطبيب عند طوارئ المريض.
- الطريقة: POST.
- المسار: /emergency/notify-doctor
- محمي: نعم.
- ما يستقبله: معرف المريض، والموقع.
- ما يرجعه: تأكيد.

---

## 18. مرضى الطبيب (لوحة الطبيب)

- المطلوب: مسار يرجع قائمة مرضى الطبيب مع بياناتهم الصحية.
- الطريقة: GET.
- المسار: /doctor/patients
- محمي: نعم، للطبيب فقط.
- ما يرجعه: قائمة مرضى. كل مريض فيه: المعرّف، الاسم، العمر، الحالة، درجة الخطورة، آخر تحديث، بيانات صحية (نبض، أكسجين، خطوات، نوم)، وعدد التنبيهات.

---

## 19. تنبيهات الطبيب

- المطلوب: مسار يرجع تنبيهات الطبيب (مريض، رسالة، وقت، درجة خطورة).
- الطريقة: GET.
- المسار: /doctor/alerts
- محمي: نعم، للطبيب فقط.
- ما يرجعه: قائمة تنبيهات.

---

## 20. اتصل بنا

- المطلوب: مسار لاستقبال رسالة من صفحة «اتصل بنا».
- الطريقة: POST.
- المسار: /contact
- محمي: لا.
- ما يستقبله: الاسم، البريد، الهاتف، الموضوع، الرسالة.
- ما يرجعه: تأكيد (مثل: تم استلام رسالتك).

---

## ملاحظات مهمة لكم

- أي مسار مكتوب عليه «محمي: نعم» معناه أن الواجهة الأمامية ترسل مع الطلب هيدر اسمه Authorization وقيمته Bearer ثم التوكن. عليكم التحقق من التوكن وإرجاع خطأ 401 إذا كان غير صالح.
- عند أي خطأ يُفضّل إرجاع جسم JSON فيه حقل message يحتوي نص الرسالة.
- إذا كانت الواجهة الأمامية تعمل على عنوان (دومين أو بورت) مختلف عن الباكند، يجب تفعيل CORS من عندكم لسماح طلبات من عنوان الفرونت.
- بعد أن يصبح الباكند جاهزاً، سنغيّر في الواجهة الأمامية عنوان السيرفر (حالياً في الكود مكتوب عنوان تجريبي) إلى عنوان السيرفر الحقيقي عندكم في الملف: frontend/src/utils/api.js

---

المجموع 20 نقطة. نفّذوهم بالترتيب والموقع يربط معاكم ويشتغل.
